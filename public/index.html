<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">¬°Aprende con Olivia! üåü</title>
    
    <!-- Fuentes educativas optimizadas para aprendizaje -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Optimizaci√≥n: Solo pesos cr√≠ticos con font-display swap -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Poppins:wght@600&display=swap" rel="stylesheet">
    <!-- Preload de la fuente principal para evitar FOUT -->
    <link rel="preload" href="https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfAZ9hiA.woff2" as="font" type="font/woff2" crossorigin>
    
    <!-- Configuraci√≥n de la aplicaci√≥n -->
    <script src="config.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-left">
                <button class="back-btn-header hidden" id="backBtnHeader" onclick="goBack()" title="Volver al men√∫">
                    <span class="back-icon">‚Üê</span>
                </button>
                <h1 class="title" id="mainTitle">¬°Aprende con Olivia! üåü</h1>
            </div>
            <div class="header-center">
                <div class="progress hidden" id="progressHeader">
                    <span id="remainingWordsHeader">Quedan 10 palabras</span>
                </div>
            </div>
            <div class="header-right">
                <div class="stats-container">
                    <div class="star-counter">
                        <span class="star" id="starIcon">‚≠ê</span>
                        <span class="counter" id="starCounter">0</span>
                    </div>
                    <div class="streak-counter">
                        <span class="streak-icon">üî•</span>
                        <span class="streak-text">Racha:</span>
                        <span class="streak-number" id="streakCounter">0</span>
                    </div>
                    <button class="help-btn" onclick="showHelpModal()" title="Ayuda y configuraci√≥n">‚ùì</button>
                </div>
            </div>
        </header>

        <main class="main-content">
            <div id="startScreen" class="start-screen">
                <div class="buttons-container">
                    <button class="game-button easy-btn" onclick="startGame('facil')">
                        <span class="button-icon">üê±</span>
                        <span class="button-text">F√ÅCIL</span>
                    </button>
                    <button class="game-button hard-btn" onclick="startGame('dificil')">
                        <span class="button-icon">ü¶Å</span>
                        <span class="button-text">DIF√çCIL</span>
                    </button>
                    <button class="game-button free-btn" onclick="startGame('libre')">
                        <span class="button-icon">üåà</span>
                        <span class="button-text">LIBRE</span>
                    </button>
                </div>
            </div>

            <div id="gameScreen" class="game-screen hidden">
                <div class="question-container">
                    <div id="questionText" class="question-text"></div>
                    <div id="questionImage" class="question-image"></div>
                </div>

                <div id="inputContainer" class="input-container">
                    <div id="wordInputWrapper" class="word-input-wrapper">
                        <input type="text" id="wordInput" class="word-input" maxlength="10" autocomplete="off" spellcheck="false">
                        <div id="hintText" class="hint-text"></div>
                    </div>
                    <button class="submit-btn disabled" id="submitBtn" onclick="submitAnswer()" title="Enviar respuesta">
                        <span class="submit-icon">‚úì</span>
                        <span class="submit-text">¬°Listo!</span>
                    </button>
                </div>

                <!-- Letras t√°ctiles para dispositivos sin teclado f√≠sico -->
                <div id="touchLettersContainer" class="touch-letters-container">
                    <div class="touch-letters-header">
                        <span class="touch-letters-title">Toca las letras:</span>
                        <button id="clearLettersBtn" class="clear-letters-btn" title="Borrar todo">
                            <span class="clear-icon">üóëÔ∏è</span>
                        </button>
                    </div>
                    <div id="touchLetters" class="touch-letters-grid"></div>
                </div>

                <div id="feedbackContainer" class="feedback-container">
                    <div id="feedbackMessage" class="feedback-message"></div>
                </div>

                <div class="game-controls">
                    <button id="nextBtn" class="next-btn hidden" onclick="nextQuestion()">Siguiente</button>
                    <button id="listenBtn" class="listen-btn" onclick="listenToWord()">
                        üîä Escuchar (<span id="listenCount">3</span>)
                    </button>
                </div>
            </div>

            <div id="freePlayScreen" class="free-play-screen hidden">
                <div class="free-play-content">
                    <div class="free-header">
                        <h2>Modo Libre üåà</h2>
                        <p>Practica cualquier palabra que quieras</p>
                    </div>
                    
                    <div class="free-main">
                        <div class="free-input-wrapper">
                            <input type="text" id="freeInput" class="free-input-large" placeholder="Escribe cualquier palabra..." autocomplete="off" spellcheck="false">
                        </div>
                        
                        <div class="free-instructions">
                            <p>Presiona <strong>Enter</strong> para escuchar la pronunciaci√≥n</p>
                        </div>
                    </div>
                    
                    <div class="free-footer">
                        <button class="back-btn-large" onclick="goBack()">‚Üê Volver al Men√∫</button>
                    </div>
                </div>
            </div>

            <div id="resultsScreen" class="results-screen hidden">
                <div class="results-content">
                    <h2 id="resultsTitle">¬°Muy bien, Olivia! üéâ</h2>
                    <div class="score">
                        <span class="score-text">Puntuaci√≥n:</span>
                        <span id="finalScore" class="score-number">0</span>
                        <span id="scoreTotalDynamic" class="score-total">/ 10</span>
                    </div>
                    <div class="stars-earned">
                        <span id="starsEarned">0</span> ‚≠ê ganadas
                    </div>
                    <button class="play-again-btn" onclick="goBack()">Jugar de nuevo</button>
                </div>
            </div>
        </main>
    </div>

    <div id="confetti-container" class="confetti-container"></div>

    <!-- Modal de Configuraci√≥n Inicial -->
    <div id="settingsModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2>¬°Hola! üëã</h2>
                <p class="modal-subtitle">Vamos a personalizar tu experiencia</p>
            </div>
            
            <div class="modal-body">
                <div class="settings-section">
                    <label for="childName" class="settings-label">
                        <span class="label-icon">‚ú®</span>
                        ¬øC√≥mo te llamas?
                    </label>
                    <input 
                        type="text" 
                        id="childName" 
                        class="settings-input" 
                        placeholder="Escribe tu nombre aqu√≠..."
                        maxlength="20"
                    />
                    <p class="settings-help">Te diremos tu nombre cuando juegues ‚ù§Ô∏è</p>
                </div>

                <div class="settings-section">
                    <label for="voiceSelect" class="settings-label">
                        <span class="label-icon">üó£Ô∏è</span>
                        Elige la voz que m√°s te guste
                    </label>
                    <select id="voiceSelect" class="settings-select">
                        <option value="">Buscando voces disponibles...</option>
                    </select>
                    <p class="settings-help">Esta voz pronunciar√° las palabras</p>
                </div>

                <div class="voice-controls">
                    <div class="voice-control-group">
                        <label for="voiceRate" class="control-label">
                            <span class="label-icon">‚è±Ô∏è</span>
                            Velocidad: <span id="rateValue">0.4</span>x
                        </label>
                        <input type="range" id="voiceRate" class="voice-slider" min="0.1" max="2.0" step="0.1" value="0.4">
                        <div class="slider-markers">
                            <span class="marker" data-value="0.5">Lenta</span>
                            <span class="marker" data-value="1.0">Normal</span>
                            <span class="marker" data-value="1.5">R√°pida</span>
                        </div>
                    </div>

                    <div class="voice-control-group">
                        <label for="voicePitch" class="control-label">
                            <span class="label-icon">üéµ</span>
                            Tono: <span id="pitchValue">2.0</span>
                        </label>
                        <input type="range" id="voicePitch" class="voice-slider" min="0.5" max="2.0" step="0.1" value="2.0">
                        <div class="slider-markers">
                            <span class="marker" data-value="1.0">Grave</span>
                            <span class="marker" data-value="1.5">Normal</span>
                            <span class="marker" data-value="2.0">Agudo</span>
                        </div>
                    </div>

                    <button type="button" id="previewVoiceBtn" class="preview-voice-btn">
                        üîä Probar voz
                    </button>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="modal-btn modal-btn-default" onclick="useDefaultSettings()">
                    Usar predeterminado
                </button>
                <button class="modal-btn modal-btn-primary" onclick="saveSettings()">
                    ¬°Listo! üåü
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Ayuda -->
    <div id="helpModal" class="modal-overlay">
        <div class="modal-content help-modal-content">
            <div class="modal-header">
                <h2>Ayuda ‚ùì</h2>
                <button class="modal-close" onclick="hideHelpModal()" title="Cerrar">√ó</button>
            </div>
            
            <div class="modal-body">
                <!-- Pesta√±as de navegaci√≥n -->
                <div class="help-tabs">
                    <button class="help-tab active" data-tab="info" onclick="showHelpTab('info')">
                        <span class="tab-icon">üìñ</span>
                        <span class="tab-text">Informaci√≥n</span>
                    </button>
                    <button class="help-tab" data-tab="settings" onclick="showHelpTab('settings')">
                        <span class="tab-icon">‚öôÔ∏è</span>
                        <span class="tab-text">Configuraci√≥n</span>
                    </button>
                    <button class="help-tab" data-tab="reset" onclick="showHelpTab('reset')">
                        <span class="tab-icon">üîÑ</span>
                        <span class="tab-text">Reiniciar</span>
                    </button>
                </div>

                <!-- Contenido de la pesta√±a Informaci√≥n -->
                <div class="help-content active" id="helpTabInfo">
                    <div class="help-section">
                        <h3>¬°Aprende escribiendo palabras! üåü</h3>
                        <div class="help-info">
                            <div class="info-item">
                                <span class="info-icon">üê±</span>
                                <div class="info-text">
                                    <strong>Modo F√°cil:</strong> 10 pistas de audio y ayuda visual
                                </div>
                            </div>
                            <div class="info-item">
                                <span class="info-icon">ü¶Å</span>
                                <div class="info-text">
                                    <strong>Modo Dif√≠cil:</strong> 5 pistas de audio y ayuda visual
                                </div>
                            </div>
                            <div class="info-item">
                                <span class="info-icon">üåà</span>
                                <div class="info-text">
                                    <strong>Modo Libre:</strong> Escribe cualquier palabra y esc√∫chala
                                </div>
                            </div>
                            <div class="info-item">
                                <span class="info-icon">üîä</span>
                                <div class="info-text">
                                    <strong>Bot√≥n Escuchar:</strong> Presiona para o√≠r la palabra
                                </div>
                            </div>
                            <div class="info-item">
                                <span class="info-icon">‚≠ê</span>
                                <div class="info-text">
                                    <strong>Estrellas:</strong> Ganas puntos por cada palabra correcta
                                </div>
                            </div>
                            <div class="info-item">
                                <span class="info-icon">üî•</span>
                                <div class="info-text">
                                    <strong>Racha:</strong> Respuestas correctas seguidas
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Contenido de la pesta√±a Configuraci√≥n -->
                <div class="help-content" id="helpTabSettings">
                    <div class="help-section">
                        <h3>Personaliza tu experiencia ‚öôÔ∏è</h3>
                        <div class="settings-section">
                            <label for="helpChildName" class="settings-label">
                                <span class="label-icon">‚ú®</span>
                                ¬øC√≥mo te llamas?
                            </label>
                            <input 
                                type="text" 
                                id="helpChildName" 
                                class="settings-input" 
                                placeholder="Escribe tu nombre aqu√≠..."
                                maxlength="20"
                            />
                            <p class="settings-help">Te diremos tu nombre cuando juegues ‚ù§Ô∏è</p>
                        </div>

                        <div class="settings-section">
                            <label for="helpVoiceSelect" class="settings-label">
                                <span class="label-icon">üó£Ô∏è</span>
                                Elige la voz que m√°s te guste
                            </label>
                            <select id="helpVoiceSelect" class="settings-select">
                                <option value="">Buscando voces disponibles...</option>
                            </select>
                            <p class="settings-help">Esta voz pronunciar√° las palabras</p>
                        </div>

                        <div class="voice-controls">
                            <div class="voice-control-group">
                                <label for="helpVoiceRate" class="control-label">
                                    <span class="label-icon">‚è±Ô∏è</span>
                                    Velocidad: <span id="helpRateValue">0.4</span>x
                                </label>
                                <input type="range" id="helpVoiceRate" class="voice-slider" min="0.1" max="2.0" step="0.1" value="0.4">
                                <div class="slider-markers">
                                    <span class="marker" data-value="0.5">Lenta</span>
                                    <span class="marker" data-value="1.0">Normal</span>
                                    <span class="marker" data-value="1.5">R√°pida</span>
                                </div>
                            </div>

                            <div class="voice-control-group">
                                <label for="helpVoicePitch" class="control-label">
                                    <span class="label-icon">üéµ</span>
                                    Tono: <span id="helpPitchValue">2.0</span>
                                </label>
                                <input type="range" id="helpVoicePitch" class="voice-slider" min="0.5" max="2.0" step="0.1" value="2.0">
                                <div class="slider-markers">
                                    <span class="marker" data-value="1.0">Grave</span>
                                    <span class="marker" data-value="1.5">Normal</span>
                                    <span class="marker" data-value="2.0">Agudo</span>
                                </div>
                            </div>

                            <button type="button" id="helpPreviewVoiceBtn" class="preview-voice-btn">
                                üîä Probar voz
                            </button>
                        </div>

                        <div class="help-section-footer">
                            <button class="modal-btn modal-btn-primary" onclick="saveHelpSettings()">
                                ¬°Guardar cambios! üåü
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Contenido de la pesta√±a Reiniciar -->
                <div class="help-content" id="helpTabReset">
                    <div class="help-section">
                        <h3>Reiniciar progreso üîÑ</h3>
                        <div class="reset-warning">
                            <div class="warning-icon">‚ö†Ô∏è</div>
                            <div class="warning-content">
                                <p><strong>¬°Atenci√≥n!</strong></p>
                                <p>Esto borrar√° todas tus estrellas y tu racha actual.</p>
                                <p>¬øEst√°s segura de que quieres empezar de nuevo?</p>
                            </div>
                        </div>
                        
                        <div class="current-stats">
                            <div class="stat-item">
                                <span class="stat-icon">‚≠ê</span>
                                <span class="stat-label">Estrellas:</span>
                                <span class="stat-value" id="helpStarCount">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">üî•</span>
                                <span class="stat-label">Racha m√°xima:</span>
                                <span class="stat-value" id="helpMaxStreak">0</span>
                            </div>
                        </div>

                        <div class="help-section-footer">
                            <button class="modal-btn modal-btn-default" onclick="hideHelpModal()">
                                Cancelar
                            </button>
                            <button class="modal-btn modal-btn-danger" onclick="confirmResetPoints()">
                                üîÑ S√≠, reiniciar todo
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>